# CSA_HW1
ИДЗ №1 по дисциплине "Архитектура вычислительный систем"
# Информация о программе и тестах.
Программа состоит из 2-х единиц компиляции (main и createArrayB).

Варианты запуска:
1. ./prog.out или ./prog.out 0 - считывание массива из консоли
2. ./prog.out 1 - считывание массива из файла input.txt (в первой строке - размер массива, во второй - элементы через пробел) и запись в output.txt.
3. ./prog.out 2 - случайная генерация массива.

Рeзультаты тестов для программы с рефакторингом (папка assembly_v.2) и без (папка assembly_v.1) можно посмотреть в папке tests.
# Рефакторинг кода.
1. Исправление моментов, когда сначала данные кладут в rax, а потом в другой регистр. Вместо этого можно класть сразу в конечный регистр.
2. В коде программы createArrayB.s изменен момент, когда значение A[i_A] считывалось два раза(для сравнения суммы и для записи в B). Вместо этого значение остается лежать в eax.
3. В main.s i было положено к r14d, вместо -4[rbp].
4. В createArrayB.s i_A было положено к r13d, вместо -4[rbp].
5. Удаление ненужных строк.

Все изменение привели к уменьшения времени работы программы примерно в 1.4 раза. (заполнение масссива B запускается 10^7 раз)
# Соответствие переменных программы адресам стека.
main.s:
1. -68[pbp] = argc
2. -80[rbp] = argv[0]
3. -72[rbp] = argv[1]
4. -52[rbp] = a_size
5. -4[rbp] = i (в программе i лежит в r14d)
6. -16[rbp] = input
6. -24[rbp] = start
7. -32[rbp] = end
8. -40[rbp] = time_spent
9. -48[rbp] = output

createArrayB.s:
1. -20[rbp] = a_size
2. -8[rbp] = k
3. -12[rbp] = sum
4. -4[rbp] = i_A (в программе i_A лежит в r13d)
# Передача параметров в функцию.
Передача параметров в функцию createArrayB производится через регистр edi, в котором хранится a_size.
